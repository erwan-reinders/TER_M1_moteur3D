<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

    <!-- ==================== FONT ==================== -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">

    <!-- ==================== CSS ==================== -->
    <link rel="stylesheet" href="css/general.css" />
    <link rel="stylesheet" href="css/ui.css" />

    <!-- ==================== JS ==================== -->
    <!-- LIB -->
    <script type="text/javascript" src="lib/gl-matrix-min.js" ></script>
    <!-- MODELS -->
    <script type="text/javascript" src="data/meshes/basic-object-models-IFS.js" ></script>
    <script type="text/javascript" src="data/meshes/teapot-model-IFS.js" ></script>

    <!-- rendering source code -->
    <script type="text/javascript" src="js/util.js" defer></script>
    <script type="text/javascript" src="js/util_ui.js" defer ></script>
    <script type="text/javascript" src="js/framebuffer.js" ></script>
    <!--
    <script type="text/javascript" src="js/texture.js" ></script>
    -->
    <script type="text/javascript" src="js/camera.js" ></script>
    <script type="text/javascript" src="js/model.js" ></script>
    <script type="text/javascript" src="js/light.js" ></script>
    <script type="text/javascript" src="js/scene.js"></script>
    <script type="text/javascript" src="js/shaderProgram.js"></script>
    <script type="text/javascript" src="js/shaderRendererResult.js"></script>
    <script type="text/javascript" src="js/shaderRenderer.js"></script>
    <script type="text/javascript" src="js/shaderPipeline.js"></script>
    <script type="text/javascript" src="js/controller.js"></script>
    
    <script type="text/javascript" src="js/Shaders/textureGBuffer.js"></script>
    <script type="text/javascript" src="js/Shaders/applyToScreen.js"></script>
    <script type="text/javascript" src="js/Shaders/blinnPhong.js"></script>
    <script type="text/javascript" src="js/Shaders/fusion.js"></script>
    <script type="text/javascript" src="js/Shaders/gammaCorrection.js"></script>
    <script type="text/javascript" src="js/Shaders/skybox.js"></script>
    <script type="text/javascript" src="js/Shaders/depthMap.js"></script>
    <script type="text/javascript" src="js/Shaders/shadow.js"></script>

    <script type="text/javascript" src="js/Builders/sceneBuilder.js"></script>
    <script type="text/javascript" src="js/Builders/shaderBuilder.js"></script>
    <script type="text/javascript" src="js/Builders/pipelineBuilder.js"></script>

</head>
<body>
    <div id="canvas-holder">
        <!--<canvas width=1200 height=600 id="webglcanvas"></canvas>-->
        <canvas id="webglcanvas" oncontextmenu="return false"></canvas>
    </div>

    <div id="options">
        <h1 id="options_title">RENDERING OPTIONS</h1>
    </div>

    <script type="text/javascript" defer>

        let updateRender = true;
        let currentScene = 0;
        let currentPipeline = 0;

        let controler;

        function init(){
            message.informative("INITIALISATION", "initialisation of the scene");
            initGl("webglcanvas");

            buildScenes();
            buildShaders();
            buildPipelines();
        }

        function main() {
            init();

            controler = new Controller(scenes[currentScene]);
            document.addEventListener('keydown', onKeyDown);
            document.addEventListener('keyup', onKeyUp);
            document.addEventListener('mousemove', onMouseMove);
            document.addEventListener('wheel', onWheel);
            document.addEventListener('mousedown', onMouseDown);
            document.addEventListener('mouseup', onMouseUp);

            frame();
        }

        function onKeyDown(event) {
            controler.onKeyDown(event);
        }
        function onKeyUp(event) {
            controler.onKeyUp(event);
        }
        function onMouseMove(event) {
            controler.onMouseMove(event);
        }
        function onWheel(event) {
            controler.onWheel(event);
        }
        function onMouseDown(event) {
            controler.onMouseDown(event);
        }
        function onMouseUp(event) {
            controler.onMouseUp(event);
        }

        function frame() {
            controler.processInput();
            if (updateRender) {
                scenes[currentScene].update();
                pipelines[currentPipeline].render(scenes[currentScene]);
            }
            requestAnimationFrame(frame);
        }


        let val = 0;
        function test_ui(){
            let obj = {
                val : 0,
                test : function () {
                    console.log(this.val);
                }
            }
            createValue_UI("val", obj, "test");
        }

        window.onload = main;
    </script>
</body>
</html>